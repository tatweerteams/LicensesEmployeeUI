{"ast":null,"code":"import _regeneratorRuntime from \"D:/repo Tatweer/tatweerteams/CheckbooksOrderingUI/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/repo Tatweer/tatweerteams/CheckbooksOrderingUI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport router from \"./index\";\nimport store from \"../store\";\nvar whiteList = [\"/login\"];\nrouter.beforeEach( /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(to, from, next) {\n    var hasToken;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return store.dispatch(\"loading\", true);\n          case 2:\n            _context.next = 4;\n            return store.dispatch(\"auth/tryAutoLogin\").catch(function () {\n              return false;\n            });\n          case 4:\n            hasToken = _context.sent;\n            if (!hasToken) {\n              _context.next = 25;\n              break;\n            }\n            if (!(to.path === \"/login\")) {\n              _context.next = 12;\n              break;\n            }\n            next({\n              path: \"/home\"\n            });\n            _context.next = 10;\n            return store.dispatch(\"loading\", false);\n          case 10:\n            _context.next = 23;\n            break;\n          case 12:\n            _context.prev = 12;\n            next();\n            _context.next = 23;\n            break;\n          case 16:\n            _context.prev = 16;\n            _context.t0 = _context[\"catch\"](12);\n            console.log(_context.t0);\n            store.dispatch(\"auth/logout\");\n            next(\"/login?redirect=\".concat(to.path));\n            _context.next = 23;\n            return store.dispatch(\"loading\", false);\n          case 23:\n            _context.next = 34;\n            break;\n          case 25:\n            if (!(whiteList.indexOf(to.path) !== -1)) {\n              _context.next = 31;\n              break;\n            }\n            _context.next = 28;\n            return store.dispatch(\"loading\", false);\n          case 28:\n            next();\n            _context.next = 34;\n            break;\n          case 31:\n            next(\"/login?redirect=\".concat(to.path));\n            _context.next = 34;\n            return store.dispatch(\"loading\", false);\n          case 34:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[12, 16]]);\n  }));\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nrouter.afterEach( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n  return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return store.dispatch(\"loading\", false);\n        case 2:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, _callee2);\n})));","map":{"version":3,"names":["router","store","whiteList","beforeEach","to","from","next","dispatch","catch","hasToken","path","console","log","indexOf","afterEach"],"sources":["D:/repo Tatweer/tatweerteams/CheckbooksOrderingUI/src/router/routerfilter.js"],"sourcesContent":["import router from \"./index\";\r\nimport store from \"../store\";\r\n\r\nconst whiteList = [\"/login\"];\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  await store.dispatch(\"loading\", true);\r\n\r\n  let hasToken = await store.dispatch(\"auth/tryAutoLogin\").catch(() => {\r\n    return false;\r\n  });\r\n\r\n  if (hasToken) {\r\n    if (to.path === \"/login\") {\r\n      next({ path: \"/home\" });\r\n      await store.dispatch(\"loading\", false);\r\n    } else {\r\n      try {\r\n        next();\r\n      } catch (error) {\r\n        console.log(error);\r\n        store.dispatch(\"auth/logout\");\r\n        next(`/login?redirect=${to.path}`);\r\n        await store.dispatch(\"loading\", false);\r\n      }\r\n    }\r\n  } else {\r\n    if (whiteList.indexOf(to.path) !== -1) {\r\n      await store.dispatch(\"loading\", false);\r\n      next();\r\n    } else {\r\n      next(`/login?redirect=${to.path}`);\r\n      await store.dispatch(\"loading\", false);\r\n    }\r\n  }\r\n});\r\n\r\nrouter.afterEach(async () => {\r\n  await store.dispatch(\"loading\", false);\r\n});\r\n"],"mappings":";;AAAA,OAAOA,MAAM,MAAM,SAAS;AAC5B,OAAOC,KAAK,MAAM,UAAU;AAE5B,IAAMC,SAAS,GAAG,CAAC,QAAQ,CAAC;AAE5BF,MAAM,CAACG,UAAU;EAAA,sEAAC,iBAAOC,EAAE,EAAEC,IAAI,EAAEC,IAAI;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,OAC/BL,KAAK,CAACM,QAAQ,CAAC,SAAS,EAAE,IAAI,CAAC;UAAA;YAAA;YAAA,OAEhBN,KAAK,CAACM,QAAQ,CAAC,mBAAmB,CAAC,CAACC,KAAK,CAAC,YAAM;cACnE,OAAO,KAAK;YACd,CAAC,CAAC;UAAA;YAFEC,QAAQ;YAAA,KAIRA,QAAQ;cAAA;cAAA;YAAA;YAAA,MACNL,EAAE,CAACM,IAAI,KAAK,QAAQ;cAAA;cAAA;YAAA;YACtBJ,IAAI,CAAC;cAAEI,IAAI,EAAE;YAAQ,CAAC,CAAC;YAAC;YAAA,OAClBT,KAAK,CAACM,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC;UAAA;YAAA;YAAA;UAAA;YAAA;YAGpCD,IAAI,EAAE;YAAC;YAAA;UAAA;YAAA;YAAA;YAEPK,OAAO,CAACC,GAAG,aAAO;YAClBX,KAAK,CAACM,QAAQ,CAAC,aAAa,CAAC;YAC7BD,IAAI,2BAAoBF,EAAE,CAACM,IAAI,EAAG;YAAC;YAAA,OAC7BT,KAAK,CAACM,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC;UAAA;YAAA;YAAA;UAAA;YAAA,MAItCL,SAAS,CAACW,OAAO,CAACT,EAAE,CAACM,IAAI,CAAC,KAAK,CAAC,CAAC;cAAA;cAAA;YAAA;YAAA;YAAA,OAC7BT,KAAK,CAACM,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC;UAAA;YACtCD,IAAI,EAAE;YAAC;YAAA;UAAA;YAEPA,IAAI,2BAAoBF,EAAE,CAACM,IAAI,EAAG;YAAC;YAAA,OAC7BT,KAAK,CAACM,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAG3C;EAAA;IAAA;EAAA;AAAA,IAAC;AAEFP,MAAM,CAACc,SAAS,0EAAC;EAAA;IAAA;MAAA;QAAA;UAAA;UAAA,OACTb,KAAK,CAACM,QAAQ,CAAC,SAAS,EAAE,KAAK,CAAC;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA;AAAA,CACvC,GAAC"},"metadata":{},"sourceType":"module"}