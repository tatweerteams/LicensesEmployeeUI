{"ast":null,"code":"import { UserTypeStateList } from \"../../../../models/enum\";\nimport { mapActions } from \"vuex\";\nexport default {\n  data: () => ({\n    filterData: {\n      name: null,\n      userType: null,\n      branchId: null,\n      regionId: null,\n      phoneNumber: null,\n      employeeNo: null,\n      pageNo: 1,\n      pageSize: 30\n    },\n    searchName: \"\",\n    userTypes: UserTypeStateList,\n    regions: [],\n    isLoadingRegion: false,\n    selectedRegion: null,\n    searchRegion: null,\n    filterRegionData: {\n      bankId: null,\n      regionName: null\n    },\n    branchs: [],\n    isLoadingBranch: false,\n    selectedBranch: null,\n    searchBranch: null,\n    filterBranchData: {\n      branchRegionId: null,\n      nameOrNumber: null\n    }\n  }),\n  watch: {\n    searchName(val) {\n      this.filterData.name = val;\n    },\n    searchRegion(val) {\n      if (this.isLoadingRegion) return;\n      this.filterRegionData.regionName = val;\n    },\n    searchBranch(val) {\n      this.filterBranchData.nameOrNumber = val;\n    },\n    selectedRegion(val) {\n      if (!val) this.clearBranchData();\n    }\n  },\n  computed: {},\n  methods: {\n    ...mapActions({\n      GetActiveBankRegions: \"bankRegionStore/GetActiveBankRegions\",\n      GetActiveBranchs: \"branchStore/GetActiveBranchs\"\n    }),\n    hasPermassion(crrentUser) {\n      this.userPermasstion = this.$store.getters[\"auth/getRole\"];\n      var result = this.userPermasstion.some(item => crrentUser.includes(item));\n      return result;\n    },\n    searchData() {\n      this.filterData.branchId = this.selectedBranch?.id;\n      this.filterData.userType = this.se?.id;\n      this.$emit(\"search-data\", this.filterData);\n    },\n    getBankRegions() {\n      this.filterRegionData.bankId = null;\n      try {\n        this.isLoadingRegion = true;\n        this.GetActiveBankRegions(this.filterRegionData).then(() => {\n          this.regions = [...this.$store.getters[\"bankRegionStore/GET_ACTIVE_BANKREGIONS\"]];\n          this.isLoadingRegion = false;\n        }).catch(error => {\n          this.notify(`${error}`, \"#1d262d\");\n          this.isLoadingRegion = false;\n        });\n      } catch (error) {\n        this.isLoadingRegion = false;\n        this.notify(error, \"#1d262d\");\n      }\n    },\n    searchBranchRegion() {\n      this.clearBranchData();\n      this.getBankRegions();\n    },\n    clearRegionData() {\n      this.isLoadingRegion = false;\n      this.regions = [];\n      this.selectedRegion = null;\n      this.searchRegion = null;\n      this.filterRegionData.bankId = null;\n      this.filterRegionData.regionName = null;\n    },\n    getBranchs() {\n      if (!this.selectedRegion) return;\n      this.filterBranchData.branchRegionId = this.selectedRegion?.bankRegionId;\n      this.isLoadingBranch = true;\n      this.GetActiveBranchs(this.filterBranchData).then(() => {\n        this.branchs = [...this.$store.getters[\"branchStore/GET_ACTIVE_BRANCHS\"]];\n        this.isLoadingBranch = false;\n      }).catch(error => {\n        this.notify(`${error}`, \"#1d262d\");\n        this.isLoadingBranch = false;\n      });\n    },\n    getBranchByRegionId() {\n      this.getBranchs();\n    },\n    clearBranchData() {\n      this.isLoadingBranch = false;\n      this.branchs = [];\n      this.selectedBranch = null;\n      this.searchBranch = null;\n      this.filterBranchData.branchRegionId = null;\n      this.filterBranchData.nameOrNumber = null;\n    },\n    notify(text, color) {\n      this.$store.commit(\"showMessage\", {\n        text: text,\n        color: color\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"AA8GA;AACA;AACA;EACAA;IACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;IAEAC;IACAC;IAEAC;IACAC;IACAC;IACAC;IACAC;MACAC;MACAC;IACA;IAEAC;IACAC;IACAC;IACAC;IACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAhB;MACA;IACA;IACAK;MACA;MACA;IACA;IACAO;MACA;IACA;IACAR;MACA;IACA;EACA;EAEAa;EACAC;IACA;MACAC;MACAC;IACA;IACAC;MACA;MACA,+CACAC,0BACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;QACA;QACA,iDACAC;UACA,gBACA,iEACA;UACA;QACA,GACAC;UACA;UACA;QACA;MACA;QACA;QACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA,6CACAJ;QACA,gBACA,yDACA;QACA;MACA,GACAC;QACA;QACA;MACA;IACA;IAEAI;MACA;IACA;IAEAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;QAAAC;QAAAC;MAAA;IACA;EACA;AACA","names":["data","filterData","name","userType","branchId","regionId","phoneNumber","employeeNo","pageNo","pageSize","searchName","userTypes","regions","isLoadingRegion","selectedRegion","searchRegion","filterRegionData","bankId","regionName","branchs","isLoadingBranch","selectedBranch","searchBranch","filterBranchData","branchRegionId","nameOrNumber","watch","computed","methods","GetActiveBankRegions","GetActiveBranchs","hasPermassion","crrentUser","searchData","getBankRegions","then","catch","searchBranchRegion","clearRegionData","getBranchs","getBranchByRegionId","clearBranchData","notify","text","color"],"sourceRoot":"src/views/userManagment/user/components","sources":["searchUserComponent.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <v-card elevation=\"3\" height=\"auto\" class=\"px-5\">\r\n      <v-row>\r\n        <v-subheader>\r\n          <v-icon class=\"mx-2\">search</v-icon>\r\n          بحث عن مستخدم\r\n        </v-subheader>\r\n      </v-row>\r\n\r\n      <v-row dense class=\"px-5\">\r\n        <v-col dense cols=\"12\" sm=\"6\" md=\"4\">\r\n          <v-text-field\r\n            v-model=\"searchName\"\r\n            label=\"اسم المستخدم\"\r\n            clearable\r\n            prepend-icon=\"search\"\r\n            @keyup=\"searchData\"\r\n          ></v-text-field>\r\n        </v-col>\r\n        <v-col dense cols=\"12\" sm=\"6\" md=\"4\">\r\n          <v-text-field\r\n            v-model=\"filterData.phoneNumber\"\r\n            label=\"رقم الهاتف\"\r\n            clearable\r\n            prepend-icon=\"search\"\r\n            @keyup=\"searchData\"\r\n          ></v-text-field>\r\n        </v-col>\r\n        <v-col dense cols=\"12\" sm=\"6\" md=\"4\">\r\n          <v-text-field\r\n            v-model=\"filterData.employeeNo\"\r\n            label=\"رقم الوظيفي\"\r\n            clearable\r\n            prepend-icon=\"search\"\r\n            @keyup=\"searchData\"\r\n          ></v-text-field>\r\n        </v-col>\r\n        <v-col\r\n          cols=\"12\"\r\n          sm=\"6\"\r\n          md=\"4\"\r\n          v-if=\"hasPermassion(['AddUserOtherBranchs', 'AdminSystem'])\"\r\n        >\r\n          <v-autocomplete\r\n            v-model=\"selectedRegion\"\r\n            :items=\"regions\"\r\n            :loading=\"isLoadingRegion\"\r\n            single-line\r\n            dense\r\n            required\r\n            :search-input.sync=\"searchRegion\"\r\n            item-text=\"regionName\"\r\n            item-value=\"bankRegionId\"\r\n            label=\"اختر المنطقة\"\r\n            placeholder=\"يجب إختيار المنطقة\"\r\n            return-object\r\n            no-data-text=\"لايوجد بيانات\"\r\n            clearable\r\n            @keyup=\"searchBranchRegion\"\r\n            @change=\"getBranchByRegionId\"\r\n            prepend-icon=\"mdi-map-marker\"\r\n          ></v-autocomplete>\r\n        </v-col>\r\n        <v-col\r\n          cols=\"12\"\r\n          sm=\"6\"\r\n          md=\"4\"\r\n          v-if=\"hasPermassion(['AddUserOtherBranchs', 'AdminSystem'])\"\r\n        >\r\n          <v-autocomplete\r\n            v-model=\"selectedBranch\"\r\n            :items=\"branchs\"\r\n            :loading=\"isLoadingBranch\"\r\n            single-line\r\n            :search-input.sync=\"searchBranch\"\r\n            item-text=\"name\"\r\n            item-value=\"id\"\r\n            label=\"اختر الفرع\"\r\n            placeholder=\"بحث عن طريق الفرع\"\r\n            return-object\r\n            no-data-text=\"لايوجد بيانات\"\r\n            clearable\r\n            @keyup=\"getBranchs\"\r\n            @change=\"searchData\"\r\n            prepend-icon=\"mdi-bank\"\r\n            dense\r\n          ></v-autocomplete>\r\n        </v-col>\r\n\r\n        <v-col dense cols=\"12\" sm=\"6\" md=\"4\">\r\n          <v-select\r\n            v-model=\"filterData.userType\"\r\n            :items=\"userTypes\"\r\n            item-text=\"name\"\r\n            item-value=\"id\"\r\n            clearable\r\n            dense\r\n            @change=\"searchData\"\r\n            prepend-icon=\"search\"\r\n            label=\"بحث عن طريق التبعية\"\r\n          >\r\n          </v-select>\r\n        </v-col>\r\n      </v-row>\r\n    </v-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { UserTypeStateList } from \"../../../../models/enum\";\r\nimport { mapActions } from \"vuex\";\r\nexport default {\r\n  data: () => ({\r\n    filterData: {\r\n      name: null,\r\n      userType: null,\r\n      branchId: null,\r\n      regionId: null,\r\n      phoneNumber: null,\r\n      employeeNo: null,\r\n      pageNo: 1,\r\n      pageSize: 30,\r\n    },\r\n\r\n    searchName: \"\",\r\n    userTypes: UserTypeStateList,\r\n\r\n    regions: [],\r\n    isLoadingRegion: false,\r\n    selectedRegion: null,\r\n    searchRegion: null,\r\n    filterRegionData: {\r\n      bankId: null,\r\n      regionName: null,\r\n    },\r\n\r\n    branchs: [],\r\n    isLoadingBranch: false,\r\n    selectedBranch: null,\r\n    searchBranch: null,\r\n    filterBranchData: {\r\n      branchRegionId: null,\r\n      nameOrNumber: null,\r\n    },\r\n  }),\r\n\r\n  watch: {\r\n    searchName(val) {\r\n      this.filterData.name = val;\r\n    },\r\n    searchRegion(val) {\r\n      if (this.isLoadingRegion) return;\r\n      this.filterRegionData.regionName = val;\r\n    },\r\n    searchBranch(val) {\r\n      this.filterBranchData.nameOrNumber = val;\r\n    },\r\n    selectedRegion(val) {\r\n      if (!val) this.clearBranchData();\r\n    },\r\n  },\r\n\r\n  computed: {},\r\n  methods: {\r\n    ...mapActions({\r\n      GetActiveBankRegions: \"bankRegionStore/GetActiveBankRegions\",\r\n      GetActiveBranchs: \"branchStore/GetActiveBranchs\",\r\n    }),\r\n    hasPermassion(crrentUser) {\r\n      this.userPermasstion = this.$store.getters[\"auth/getRole\"];\r\n      var result = this.userPermasstion.some((item) =>\r\n        crrentUser.includes(item)\r\n      );\r\n      return result;\r\n    },\r\n    searchData() {\r\n      this.filterData.branchId=this.selectedBranch?.id;\r\n      this.filterData.userType=this.se?.id;\r\n      this.$emit(\"search-data\", this.filterData);\r\n    },\r\n\r\n    getBankRegions() {\r\n      this.filterRegionData.bankId = null;\r\n      try {\r\n        this.isLoadingRegion = true;\r\n        this.GetActiveBankRegions(this.filterRegionData)\r\n          .then(() => {\r\n            this.regions = [\r\n              ...this.$store.getters[\"bankRegionStore/GET_ACTIVE_BANKREGIONS\"],\r\n            ];\r\n            this.isLoadingRegion = false;\r\n          })\r\n          .catch((error) => {\r\n            this.notify(`${error}`, \"#1d262d\");\r\n            this.isLoadingRegion = false;\r\n          });\r\n      } catch (error) {\r\n        this.isLoadingRegion = false;\r\n        this.notify(error, \"#1d262d\");\r\n      }\r\n    },\r\n\r\n    searchBranchRegion() {\r\n      this.clearBranchData();\r\n      this.getBankRegions();\r\n    },\r\n\r\n    clearRegionData() {\r\n      this.isLoadingRegion = false;\r\n      this.regions = [];\r\n      this.selectedRegion = null;\r\n      this.searchRegion = null;\r\n      this.filterRegionData.bankId = null;\r\n      this.filterRegionData.regionName = null;\r\n    },\r\n\r\n    getBranchs() {\r\n      if (!this.selectedRegion) return;\r\n      this.filterBranchData.branchRegionId = this.selectedRegion?.bankRegionId;\r\n      this.isLoadingBranch = true;\r\n      this.GetActiveBranchs(this.filterBranchData)\r\n        .then(() => {\r\n          this.branchs = [\r\n            ...this.$store.getters[\"branchStore/GET_ACTIVE_BRANCHS\"],\r\n          ];\r\n          this.isLoadingBranch = false;\r\n        })\r\n        .catch((error) => {\r\n          this.notify(`${error}`, \"#1d262d\");\r\n          this.isLoadingBranch = false;\r\n        });\r\n    },\r\n\r\n    getBranchByRegionId() {\r\n      this.getBranchs();\r\n    },\r\n\r\n    clearBranchData() {\r\n      this.isLoadingBranch = false;\r\n      this.branchs = [];\r\n      this.selectedBranch = null;\r\n      this.searchBranch = null;\r\n      this.filterBranchData.branchRegionId = null;\r\n      this.filterBranchData.nameOrNumber = null;\r\n    },\r\n\r\n    notify(text, color) {\r\n      this.$store.commit(\"showMessage\", { text: text, color: color });\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style></style>\r\n"]},"metadata":{},"sourceType":"module"}